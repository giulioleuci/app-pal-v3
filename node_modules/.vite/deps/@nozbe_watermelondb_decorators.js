import {
  require_Relation
} from "./chunk-34UZUV7I.js";
import {
  require_lazy,
  require_makeDecorator,
  require_rx
} from "./chunk-UI2AWJZP.js";
import {
  require_logError
} from "./chunk-OXRMU63H.js";
import {
  require_QueryDescription
} from "./chunk-7IBXDPTB.js";
import {
  require_extends,
  require_fp,
  require_interopRequireDefault,
  require_invariant
} from "./chunk-UA6MBTDI.js";
import {
  __commonJS
} from "./chunk-OL46QLBJ.js";

// node_modules/@nozbe/watermelondb/decorators/action/index.js
var require_action = __commonJS({
  "node_modules/@nozbe/watermelondb/decorators/action/index.js"(exports) {
    "use strict";
    var _interopRequireDefault = require_interopRequireDefault();
    exports.__esModule = true;
    exports.reader = reader;
    exports.writer = writer;
    var _extends2 = _interopRequireDefault(require_extends());
    function writer(target, key, descriptor) {
      var actionName = "".concat(target.table || target.constructor.name, ".").concat(key);
      return (0, _extends2.default)({}, descriptor, {
        value: function(...args) {
          var _this = this;
          return this.database.write(function() {
            return descriptor.value.apply(_this, args);
          }, actionName);
        }
      });
    }
    function reader(target, key, descriptor) {
      var actionName = "".concat(target.table || target.constructor.name, ".").concat(key);
      return (0, _extends2.default)({}, descriptor, {
        value: function(...args) {
          var _this2 = this;
          return this.database.read(function() {
            return descriptor.value.apply(_this2, args);
          }, actionName);
        }
      });
    }
  }
});

// node_modules/@nozbe/watermelondb/decorators/children/index.js
var require_children = __commonJS({
  "node_modules/@nozbe/watermelondb/decorators/children/index.js"(exports) {
    "use strict";
    var _interopRequireDefault = require_interopRequireDefault();
    exports.__esModule = true;
    exports.default = void 0;
    var _makeDecorator = _interopRequireDefault(require_makeDecorator());
    var _logError = _interopRequireDefault(require_logError());
    var _invariant = _interopRequireDefault(require_invariant());
    var Q = _interopRequireWildcard(require_QueryDescription());
    function _getRequireWildcardCache(e) {
      if ("function" != typeof WeakMap) return null;
      var r = /* @__PURE__ */ new WeakMap(), t = /* @__PURE__ */ new WeakMap();
      return (_getRequireWildcardCache = function _getRequireWildcardCache2(e2) {
        return e2 ? t : r;
      })(e);
    }
    function _interopRequireWildcard(e, r) {
      if (!r && e && e.__esModule) return e;
      if (null === e || "object" != typeof e && "function" != typeof e) return { default: e };
      var t = _getRequireWildcardCache(r);
      if (t && t.has(e)) return t.get(e);
      var n = { __proto__: null }, a = Object.defineProperty && Object.getOwnPropertyDescriptor;
      for (var u in e) if ("default" !== u && {}.hasOwnProperty.call(e, u)) {
        var i = a ? Object.getOwnPropertyDescriptor(e, u) : null;
        i && (i.get || i.set) ? Object.defineProperty(n, u, i) : n[u] = e[u];
      }
      return n.default = e, t && t.set(e, n), n;
    }
    var children = (0, _makeDecorator.default)(function(childTable) {
      return function() {
        return {
          get: function() {
            var that = this;
            that._childrenQueryCache = that._childrenQueryCache || {};
            var cachedQuery = that._childrenQueryCache[childTable];
            if (cachedQuery) {
              return cachedQuery;
            }
            var model = that.asModel;
            var childCollection = model.collections.get(childTable);
            var association = model.constructor.associations[childTable];
            (0, _invariant.default)(association && "has_many" === association.type, "@children decorator used for a table that's not has_many");
            var query = childCollection.query(Q.where(association.foreignKey, model.id));
            that._childrenQueryCache[childTable] = query;
            return query;
          },
          set: function() {
            (0, _logError.default)("Setter called on a @children-marked property");
          }
        };
      };
    });
    var _default = exports.default = children;
  }
});

// node_modules/@nozbe/watermelondb/decorators/common.js
var require_common = __commonJS({
  "node_modules/@nozbe/watermelondb/decorators/common.js"(exports) {
    "use strict";
    var _interopRequireDefault = require_interopRequireDefault();
    exports.__esModule = true;
    exports.ensureDecoratorUsedProperly = ensureDecoratorUsedProperly;
    var _invariant = _interopRequireDefault(require_invariant());
    function ensureDecoratorUsedProperly(columnName, target, key, descriptor) {
      (0, _invariant.default)(columnName, "Pass column name (raw field name) to the decorator - error in ".concat(target.constructor.name, ".prototype.").concat(key, " given."));
      if (descriptor) {
        (0, _invariant.default)("initializer" in descriptor, "Model field decorators can only be used for simple properties - method, setter or getter ".concat(target.constructor.name, ".prototype.").concat(key, " given."));
        (0, _invariant.default)("function" !== typeof descriptor.initializer, 'Model field decorators must not be used on properties with a default value - error in "'.concat(target.constructor.name, ".prototype.").concat(key, '".'));
      }
    }
  }
});

// node_modules/@nozbe/watermelondb/decorators/json/index.js
var require_json = __commonJS({
  "node_modules/@nozbe/watermelondb/decorators/json/index.js"(exports) {
    "use strict";
    exports.__esModule = true;
    exports.jsonDecorator = exports.default = void 0;
    var _common = require_common();
    var parseJSON = function(value) {
      if (null === value || value === void 0 || "" === value) {
        return void 0;
      }
      try {
        return JSON.parse(value);
      } catch (_) {
        return void 0;
      }
    };
    var defaultOptions = {
      memo: false
    };
    var jsonDecorator = exports.jsonDecorator = function(rawFieldName, sanitizer, options = defaultOptions) {
      return function(target, key, descriptor) {
        (0, _common.ensureDecoratorUsedProperly)(rawFieldName, target, key, descriptor);
        return {
          configurable: true,
          enumerable: true,
          get: function get() {
            var model = this;
            var rawValue = model.asModel._getRaw(rawFieldName);
            if (options.memo) {
              model._jsonDecoratorCache = model._jsonDecoratorCache || {};
              var cachedEntry = model._jsonDecoratorCache[rawFieldName];
              if (cachedEntry && cachedEntry[0] === rawValue) {
                return cachedEntry[1];
              }
            }
            var parsedValue = parseJSON(rawValue);
            var sanitized = sanitizer(parsedValue, model);
            if (options.memo) {
              model._jsonDecoratorCache[rawFieldName] = [rawValue, sanitized];
            }
            return sanitized;
          },
          set: function set(json) {
            var model = this;
            var sanitizedValue = sanitizer(json, model);
            var stringifiedValue = null != sanitizedValue ? JSON.stringify(sanitizedValue) : null;
            model.asModel._setRaw(rawFieldName, stringifiedValue);
          }
        };
      };
    };
    var _default = exports.default = jsonDecorator;
  }
});

// node_modules/@nozbe/watermelondb/decorators/nochange/index.js
var require_nochange = __commonJS({
  "node_modules/@nozbe/watermelondb/decorators/nochange/index.js"(exports) {
    "use strict";
    var _interopRequireDefault = require_interopRequireDefault();
    exports.__esModule = true;
    exports.default = void 0;
    var _extends2 = _interopRequireDefault(require_extends());
    var _makeDecorator = _interopRequireDefault(require_makeDecorator());
    var _invariant = _interopRequireDefault(require_invariant());
    var nochange = (0, _makeDecorator.default)(function() {
      return function(target, key, descriptor) {
        (0, _invariant.default)(descriptor.set, "@nochange can only be applied to model fields (to properties with a setter)");
        var errorMessage = "Attempt to set a new value on a @nochange field: ".concat(target.constructor.name, ".prototype.").concat(key);
        return (0, _extends2.default)({}, descriptor, {
          set: function(value) {
            var model = this;
            (0, _invariant.default)("create" === model.asModel._preparedState, errorMessage);
            descriptor.set.call(model, value);
          }
        });
      };
    });
    var _default = exports.default = nochange;
  }
});

// node_modules/@nozbe/watermelondb/decorators/field/index.js
var require_field = __commonJS({
  "node_modules/@nozbe/watermelondb/decorators/field/index.js"(exports) {
    "use strict";
    var _interopRequireDefault = require_interopRequireDefault();
    exports.__esModule = true;
    exports.default = void 0;
    var _makeDecorator = _interopRequireDefault(require_makeDecorator());
    var _common = require_common();
    var field = (0, _makeDecorator.default)(function(columnName) {
      return function(target, key, descriptor) {
        (0, _common.ensureDecoratorUsedProperly)(columnName, target, key, descriptor);
        return {
          configurable: true,
          enumerable: true,
          get: function() {
            return this.asModel._getRaw(columnName);
          },
          set: function(value) {
            this.asModel._setRaw(columnName, value);
          }
        };
      };
    });
    var _default = exports.default = field;
  }
});

// node_modules/@nozbe/watermelondb/utils/common/memory/index.js
var require_memory = __commonJS({
  "node_modules/@nozbe/watermelondb/utils/common/memory/index.js"(exports) {
    "use strict";
    exports.__esModule = true;
    exports._triggerOnLowMemory = _triggerOnLowMemory;
    exports.onLowMemory = onLowMemory;
    var lowMemoryCallbacks = [];
    function onLowMemory(callback) {
      lowMemoryCallbacks.push(callback);
    }
    function _triggerOnLowMemory() {
      lowMemoryCallbacks.forEach(function(callback) {
        return callback();
      });
    }
  }
});

// node_modules/@nozbe/watermelondb/decorators/date/index.js
var require_date = __commonJS({
  "node_modules/@nozbe/watermelondb/decorators/date/index.js"(exports) {
    "use strict";
    var _interopRequireDefault = require_interopRequireDefault();
    exports.__esModule = true;
    exports.default = void 0;
    var _makeDecorator = _interopRequireDefault(require_makeDecorator());
    var _memory = require_memory();
    var _common = require_common();
    var cache = /* @__PURE__ */ new Map();
    (0, _memory.onLowMemory)(function() {
      return cache.clear();
    });
    var dateDecorator = (0, _makeDecorator.default)(function(columnName) {
      return function(target, key, descriptor) {
        (0, _common.ensureDecoratorUsedProperly)(columnName, target, key, descriptor);
        return {
          configurable: true,
          enumerable: true,
          get: function() {
            var rawValue = this.asModel._getRaw(columnName);
            if ("number" === typeof rawValue) {
              var cached = cache.get(rawValue);
              if (cached) {
                return cached;
              }
              var date = new Date(rawValue);
              cache.set(rawValue, date);
              return date;
            }
            return null;
          },
          set: function(date) {
            var rawValue = date ? +new Date(date) : null;
            if (rawValue && date) {
              cache.set(rawValue, new Date(date));
            }
            this.asModel._setRaw(columnName, rawValue);
          }
        };
      };
    });
    var _default = exports.default = dateDecorator;
  }
});

// node_modules/@nozbe/watermelondb/decorators/text/index.js
var require_text = __commonJS({
  "node_modules/@nozbe/watermelondb/decorators/text/index.js"(exports) {
    "use strict";
    var _interopRequireDefault = require_interopRequireDefault();
    exports.__esModule = true;
    exports.default = void 0;
    var _makeDecorator = _interopRequireDefault(require_makeDecorator());
    var _common = require_common();
    var text = (0, _makeDecorator.default)(function(columnName) {
      return function(target, key, descriptor) {
        (0, _common.ensureDecoratorUsedProperly)(columnName, target, key, descriptor);
        return {
          configurable: true,
          enumerable: true,
          get: function() {
            return this.asModel._getRaw(columnName);
          },
          set: function(value) {
            this.asModel._setRaw(columnName, "string" === typeof value ? value.trim() : null);
          }
        };
      };
    });
    var _default = exports.default = text;
  }
});

// node_modules/@nozbe/watermelondb/decorators/readonly/index.js
var require_readonly = __commonJS({
  "node_modules/@nozbe/watermelondb/decorators/readonly/index.js"(exports) {
    "use strict";
    var _interopRequireDefault = require_interopRequireDefault();
    exports.__esModule = true;
    exports.default = void 0;
    var _extends2 = _interopRequireDefault(require_extends());
    var _makeDecorator = _interopRequireDefault(require_makeDecorator());
    var _invariant = _interopRequireDefault(require_invariant());
    var readonly = (0, _makeDecorator.default)(function() {
      return function(target, key, descriptor) {
        if (descriptor.get || descriptor.set) {
          return (0, _extends2.default)({}, descriptor, {
            set: function() {
              (0, _invariant.default)(false, "Attempt to set new value on a property ".concat(target.constructor.name, ".prototype.").concat(key, " marked as @readonly"));
            }
          });
        }
        descriptor.writable = false;
        return descriptor;
      };
    });
    var _default = exports.default = readonly;
  }
});

// node_modules/@nozbe/watermelondb/decorators/relation/index.js
var require_relation = __commonJS({
  "node_modules/@nozbe/watermelondb/decorators/relation/index.js"(exports) {
    "use strict";
    var _interopRequireDefault = require_interopRequireDefault();
    exports.__esModule = true;
    exports.default = void 0;
    var _common = require_common();
    var _Relation = _interopRequireDefault(require_Relation());
    var relation = function(relationTable, relationIdColumn, options) {
      return function(target, key, descriptor) {
        (0, _common.ensureDecoratorUsedProperly)(relationIdColumn, target, key, descriptor);
        return {
          get: function() {
            var model = this;
            model._relationCache = model._relationCache || {};
            var cachedRelation = model._relationCache[key];
            if (cachedRelation) {
              return cachedRelation;
            }
            var newRelation = new _Relation.default(model.asModel, relationTable, relationIdColumn, options || {
              isImmutable: false
            });
            model._relationCache[key] = newRelation;
            return newRelation;
          },
          set: function() {
            throw new Error("Don't set relation directly. Use relation.set() instead");
          }
        };
      };
    };
    var _default = exports.default = relation;
  }
});

// node_modules/@nozbe/watermelondb/decorators/immutableRelation/index.js
var require_immutableRelation = __commonJS({
  "node_modules/@nozbe/watermelondb/decorators/immutableRelation/index.js"(exports) {
    "use strict";
    var _interopRequireDefault = require_interopRequireDefault();
    exports.__esModule = true;
    exports.default = void 0;
    var _relation = _interopRequireDefault(require_relation());
    var immutableRelation = function(relationTable, relationIdColumn) {
      return (0, _relation.default)(relationTable, relationIdColumn, {
        isImmutable: true
      });
    };
    var _default = exports.default = immutableRelation;
  }
});

// node_modules/@nozbe/watermelondb/decorators/experimentalFailsafe/index.js
var require_experimentalFailsafe = __commonJS({
  "node_modules/@nozbe/watermelondb/decorators/experimentalFailsafe/index.js"(exports) {
    "use strict";
    var _interopRequireDefault = require_interopRequireDefault();
    exports.__esModule = true;
    exports.default = void 0;
    var _extends2 = _interopRequireDefault(require_extends());
    var _fp = require_fp();
    var _rx = require_rx();
    var failsafe = function(fallback = void 0) {
      return function(target, key, descriptor) {
        return (0, _extends2.default)({}, descriptor, {
          get: function() {
            var value;
            var unsafeThis = this;
            if ("value" in descriptor) {
              value = descriptor.value;
            } else if ("get" in descriptor) {
              value = descriptor.get.call(unsafeThis);
            } else if ("initializer" in descriptor) {
              value = descriptor.initializer.call(unsafeThis);
            }
            if (value && (0, _fp.isObj)(value)) {
              var originalFetch = value.fetch;
              var originalObserve = value.observe;
              if ("function" === typeof originalFetch) {
                value.fetch = function(...args) {
                  var result = originalFetch.apply(value, args);
                  if ((0, _fp.isObj)(result) && "function" === typeof result.catch) {
                    return result.catch(function() {
                      return fallback;
                    });
                  }
                  return result;
                };
              }
              if ("function" === typeof originalObserve) {
                value.observe = function(...args) {
                  var result = originalObserve.apply(value, args);
                  if ((0, _fp.isObj)(result) && "function" === typeof result.pipe) {
                    return result.pipe((0, _rx.catchError)(function() {
                      return (0, _rx.of)(fallback);
                    }));
                  }
                  return result;
                };
              }
            }
            Object.defineProperty(unsafeThis, key, {
              value,
              enumerable: descriptor.enumerable
            });
            return value;
          }
        });
      };
    };
    var _default = exports.default = failsafe;
  }
});

// node_modules/@nozbe/watermelondb/decorators/index.js
var require_decorators = __commonJS({
  "node_modules/@nozbe/watermelondb/decorators/index.js"(exports) {
    var _interopRequireDefault = require_interopRequireDefault();
    exports.__esModule = true;
    exports.writer = exports.text = exports.relation = exports.readonly = exports.reader = exports.nochange = exports.lazy = exports.json = exports.immutableRelation = exports.field = exports.experimentalFailsafe = exports.date = exports.children = void 0;
    var _action = require_action();
    exports.writer = _action.writer;
    exports.reader = _action.reader;
    var _children = _interopRequireDefault(require_children());
    exports.children = _children.default;
    var _json = _interopRequireDefault(require_json());
    exports.json = _json.default;
    var _nochange = _interopRequireDefault(require_nochange());
    exports.nochange = _nochange.default;
    var _field = _interopRequireDefault(require_field());
    exports.field = _field.default;
    var _date = _interopRequireDefault(require_date());
    exports.date = _date.default;
    var _text = _interopRequireDefault(require_text());
    exports.text = _text.default;
    var _readonly = _interopRequireDefault(require_readonly());
    exports.readonly = _readonly.default;
    var _lazy = _interopRequireDefault(require_lazy());
    exports.lazy = _lazy.default;
    var _relation = _interopRequireDefault(require_relation());
    exports.relation = _relation.default;
    var _immutableRelation = _interopRequireDefault(require_immutableRelation());
    exports.immutableRelation = _immutableRelation.default;
    var _experimentalFailsafe = _interopRequireDefault(require_experimentalFailsafe());
    exports.experimentalFailsafe = _experimentalFailsafe.default;
  }
});
export default require_decorators();
//# sourceMappingURL=@nozbe_watermelondb_decorators.js.map
